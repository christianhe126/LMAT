//@ui5-bundle ui/Component-preload.js
sap.ui.require.preload({
	"ui/Component.js":function(){
sap.ui.define(["sap/ui/core/UIComponent","sap/ui/Device","ui/model/models","sap/ui/model/odata/v4/ODataModel","sap/ui/model/json/JSONModel","ui/dist/resources/thirdparty/pptxgenjs/pptxgenjs"],function(e,t,n,i,o){"use strict";return e.extend("ui.Component",{metadata:{manifest:"json"},buildTree:function(e){const t=new Map(e.map(e=>[e.entityID,{...e,children:[]}]));const n=[];e.forEach(e=>{if(e.parent_entityID){const n=t.get(e.parent_entityID);n.children.push(t.get(e.entityID))}else{n.push(t.get(e.entityID))}});return n},fetchData:function(e,t=null){return new Promise((n,i)=>{jQuery.ajax({type:"GET",contentType:"application/json",url:e,success:function(e,i){if(t){e.value=t(e.value)}n(e)},error:function(e,t){i(t)}})})},init:function(){e.prototype.init.apply(this,arguments);this.getRouter().initialize();this.setModel(n.createDeviceModel(),"device");console.log("aaaaabc");const t=new pptxgen;t.layout="LAYOUT_WIDE";this.fetchData("/browse/entities?$expand=content($expand=contentType)",this.buildTree).then(e=>{this.setModel(new o(e),"entities");console.log(e)});this.fetchData("/browse/contents").then(e=>{this.setModel(new o(e),"contents")});this.fetchData("/browse/contentTypes").then(e=>{this.setModel(new o(e),"contentTypes")})}})});
},
	"ui/controller/App.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("ui.controller.App",{onInit(){}})});
},
	"ui/controller/Main.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageBox","sap/m/Dialog","sap/m/Button","sap/ui/core/HTML","../model/utility"],function(e,t,n,o,r,a,i){"use strict";return e.extend("ui.controller.Main",{onInit:function(e){},autoUpdateContent:function(){var e=this.getView().getModel();var t=e.bindContext("/getAutoContent(...)");console.log(this.getView().getModel("selected").getData());const n=this.getView().getModel("selected").getProperty("/content/contentType/name");const o=this.getView().getModel("selected").getProperty("/content/url");const r=this.getView().getModel("selected").getProperty("/content/selector");console.log(n,o,r);t.setParameter("content",this.getView().getModel("selected").getProperty("/content"));t.execute().then(()=>{var e=t.getBoundContext().getObject();console.log("Data received:",e);this.getView().getModel("selected").setProperty("/content",e);console.log(this.getView().getModel("selected").getData())}).catch(function(e){console.error("Error:",e)})},openPopup:function(){var e="https://www.google.com";var t=new a({content:"<iframe src='"+e+"' style='width: 100%; height: 100%; border: 0;'></iframe>"});var n=new o({title:"External Content",contentWidth:"800px",contentHeight:"600px",content:t,beginButton:new r({text:"Close",press:function(){n.close()}})});n.open()},expandAll:function(){var e=this.getView().byId("TreeTable");e.expandToLevel(3)},exportPressed:function(){var e=JSON.stringify(this.getOwnerComponent().getModel("entities").getData().value);console.log(e);fetch("http://localhost:4004/export/generate_ppt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e})}).then(e=>{if(!e.ok){throw new Error("Network response was not ok "+e.statusText)}return e.text()}).then(e=>{let t=i.base64ToBlob(JSON.parse(e).value,"application/vnd.openxmlformats-officedocument.presentationml.presentation");const n=URL.createObjectURL(t);const o=document.createElement("a");o.href=n;o.download="MyPresentation.pptx";document.body.appendChild(o);o.click();o.remove()}).catch(e=>{n.error("Failed to generate presentation: "+e.message)})},importPressed:function(){fetch("http://localhost:4004/export/import_ppt",{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>{if(!e.ok){throw new Error("Network response was not ok "+e.statusText)}return e.text()}).then(e=>{console.log(e)}).catch(e=>{n.error("Failed to generate presentation: "+e.message)})},onTreeCellClick:function(e){var n=this.byId("TreeTable");var o=e.getParameter("rowIndex");var r=e.getParameter("cellControl").getParent().getIndex();var a=e.getParameter("rowBindingContext");if(a){var i=a.getObject();var s=new t(i);this.getView().setModel(s,"selected");console.log(i);this.getSplitAppObj().to(this.createId("detailDetail"))}},resourceListItemSelectionChange:function(e){var t=e.getParameter("listItem");var n=t.getBindingContext("contentTypes");var o=n.getObject();var r=this.getOwnerComponent().getModel("entities").getData().value;r.push({EntityID:i.findHighestEntityID(r)+1,parentEntityID:0,resourceID_resourceID:0,content:"New "+o.name,contentType:o.name,nodes:[]});this.getOwnerComponent().getModel("entities").setData({value:r});e.getSource().removeSelections(true)},onSave:function(){const e=this.getView().getModel("selected").getProperty("/entityID");var t=this.getOwnerComponent().getModel("entities").getData().value;let n=i.findInTree(e,t);n=this.getView().getModel("selected").getData();this.getOwnerComponent().getModel("entities").setData({value:t})},onPressDetailBack:function(e){this.getSplitAppObj().backDetail()},moveItemInTree:function(e,t){var n=e.getSource();var o=this.byId("myTree");var r=n.getParent().getModel();var a=r.getData();var i=n.getBindingContext();var s=i.getPath();var g=parseInt(s.split("/").pop(),10);if(t==1&&g>=1||t==-1&&g<=a.length-1){var l=s.substring(0,s.lastIndexOf("/"));var c=l?r.getProperty(l):a;var d=c[g-t];c[g-t]=c[g];c[g]=d;r.refresh()}},treeItemUpPress:function(e){this.moveItemInTree(e,1)},treeItemDownPress:function(e){this.moveItemInTree(e,-1)},onDragStart:function(e){var t=this.byId("TreeTable");var n=e.getParameter("dragSession");var o=e.getParameter("target");var r=o.getIndex();var a=t.getSelectedIndices();var i=[];if(a.length>0){if(a.indexOf(r)===-1){e.preventDefault()}else{for(var s=0;s<a.length;s++){i.push(t.getContextByIndex(a[s]))}}}else{i.push(t.getContextByIndex(r))}n.setComplexData("hierarchymaintenance",{draggedRowContexts:i})},onDrop:function(e){var t=this.byId("TreeTable");var n=e.getParameter("dragSession");var o=e.getParameter("droppedControl");var r=n.getComplexData("hierarchymaintenance").draggedRowContexts;var a=t.getContextByIndex(o.getIndex());if(r.length===0||!a){return}var i=t.getBinding().getModel();var s=a.getProperty();if(!s.nodes){s.nodes=[]}var g=false;for(var l=0;l<r.length;l++){if(a.getPath().indexOf(r[l].getPath())===0){continue}console.log(r[l].getPath());s.nodes.push(r[l].getProperty());i.setProperty(r[l].getPath(),undefined,r[l],true);g=true}if(g){t.expand(o.getIndex())}},getSplitAppObj:function(){var e=this.byId("SplitApp");if(!e){Log.info("SplitApp object can't be found")}return e}})});
},
	"ui/controller/ui.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller"],function(n){"use strict";return n.extend("ui.controller.ui",{onInit:function(){}})});
},
	"ui/i18n/i18n.properties":'# This is the resource bundle for ui\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=App Title\n\n#YDES: Application description\nappDescription=A Fiori application.\n#XTIT: Main view title\ntitle=App Title',
	"ui/manifest.json":'{"_version":"1.49.0","sap.app":{"id":"ui","type":"application","applicationVersion":{"version":"0.0.1"},"i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""],"fallbackLocale":""},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.8.5","toolsId":"f8ee46c5-0738-49c8-8953-62a7701aeedd"},"dataSources":{"mainService":{"uri":"/browse/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.123.1","libs":{"sap.m":{},"sap.ui.core":{},"sap.f":{},"sap.suite.ui.generic.template":{},"sap.ui.comp":{},"sap.ui.generic.app":{},"sap.ui.table":{},"sap.ushell":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"test":{"type":"sap.ui.model.json.JSONModel","settings":{"defaultBindingMode":"TwoWay"}},"":{"dataSource":"mainService","type":"sap.ui.model.odata.v4.ODataModel","preload":false,"settings":{"synchronizationMode":"None","operationMode":"Server","autoExpandSelect":true}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","viewType":"XML","async":true,"viewPath":"ui.view","controlAggregation":"pages","controlId":"app","clearControlAggregation":false},"routes":[{"name":"main","pattern":":?query:","target":"main"}],"targets":{"main":{"viewName":"Main","viewId":"main","viewLevel":1,"controlAggregation":"pages","controlId":"app"},"Targetui":{"viewType":"XML","transition":"slide","clearControlAggregation":false,"viewId":"ui","viewName":"ui"}}},"rootView":{"viewName":"ui.view.App","type":"XML","async":true,"id":"app"},"config":{"sample":{"files":["Main.view.xml","Main.controller.js","manifest.json"]}}}}',
	"ui/model/models.js":function(){
sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
},
	"ui/model/utility.js":function(){
sap.ui.define([],function(){"use strict";var n={};n.base64ToBlob=function(n,t){const e=atob(n);const o=[];for(let n=0;n<e.length;n+=512){const t=e.slice(n,n+512);const r=new Array(t.length);for(let n=0;n<t.length;n++){r[n]=t.charCodeAt(n)}const i=new Uint8Array(r);o.push(i)}const r=new Blob(o,{type:t});return r};n.findInTree=function(n,t){for(let e of t){if(e.entityID===n){return e}if(e.nodes){let t=this.findInTree(n,e.nodes);if(t){return t}}}return null};n.findHighestEntityID=function(n){let t=0;function e(n){n.forEach(n=>{if(n&&n.entityID>t){t=n.entityID}if(n&&n.nodes){e(n.nodes)}})}e(n);return t};return n});
},
	"ui/utils/locate-reuse-libs.js":'(function(sap){var e=function(e,t){var n=["sap.apf","sap.base","sap.chart","sap.collaboration","sap.f","sap.fe","sap.fileviewer","sap.gantt","sap.landvisz","sap.m","sap.ndc","sap.ovp","sap.rules","sap.suite","sap.tnt","sap.ui","sap.uiext","sap.ushell","sap.uxap","sap.viz","sap.webanalytics","sap.zen"];Object.keys(e).forEach(function(e){if(!n.some(function(t){return e===t||e.startsWith(t+".")})){if(t.length>0){t=t+","+e}else{t=e}}});return t};var t=function(t){var n="";if(t){if(t["sap.ui5"]&&t["sap.ui5"].dependencies){if(t["sap.ui5"].dependencies.libs){n=e(t["sap.ui5"].dependencies.libs,n)}if(t["sap.ui5"].dependencies.components){n=e(t["sap.ui5"].dependencies.components,n)}}if(t["sap.ui5"]&&t["sap.ui5"].componentUsages){n=e(t["sap.ui5"].componentUsages,n)}}return n};var n=function(e){var n=e;return new Promise(function(r,a){$.ajax(n).done(function(e){r(t(e))}).fail(function(){a(new Error("Could not fetch manifest at \'"+e))})})};var r=function(e){if(e){Object.keys(e).forEach(function(t){var n=e[t];if(n&&n.dependencies){n.dependencies.forEach(function(e){if(e.url&&e.url.length>0&&e.type==="UI5LIB"){jQuery.sap.log.info("Registering Library "+e.componentId+" from server "+e.url);jQuery.sap.registerModulePath(e.componentId,e.url)}})}})}};sap.registerComponentDependencyPaths=function(e){return n(e).then(function(e){if(e&&e.length>0){var t="/sap/bc/ui2/app_index/ui5_app_info?id="+e;var n=jQuery.sap.getUriParameters().get("sap-client");if(n&&n.length===3){t=t+"&sap-client="+n}return $.ajax(t).done(r)}})}})(sap);var scripts=document.getElementsByTagName("script");var currentScript=document.getElementById("locate-reuse-libs");if(!currentScript){currentScript=document.currentScript}var manifestUri=currentScript.getAttribute("data-sap-ui-manifest-uri");var componentName=currentScript.getAttribute("data-sap-ui-componentName");var useMockserver=currentScript.getAttribute("data-sap-ui-use-mockserver");var bundleResources=function(){jQuery.sap.require("jquery.sap.resources");var e=sap.ui.getCore().getConfiguration().getLanguage();var t=jQuery.sap.resources({url:"i18n/i18n.properties",locale:e});document.title=t.getText("appTitle")};sap.registerComponentDependencyPaths(manifestUri).catch(function(e){jQuery.sap.log.error(e)}).finally(function(){sap.ui.getCore().attachInit(bundleResources);if(componentName&&componentName.length>0){if(useMockserver&&useMockserver==="true"){sap.ui.getCore().attachInit(function(){sap.ui.require([componentName.replace(/\\./g,"/")+"/localService/mockserver"],function(e){e.init();sap.ushell.Container.createRenderer().placeAt("content")})})}else{sap.ui.require(["sap/ui/core/ComponentSupport"]);sap.ui.getCore().attachInit(bundleResources)}}else{sap.ui.getCore().attachInit(function(){sap.ushell.Container.createRenderer().placeAt("content")})}});sap.registerComponentDependencyPaths(manifestUri);\n',
	"ui/view/App.view.xml":'<mvc:View controllerName="ui.controller.App"\n    xmlns:html="http://www.w3.org/1999/xhtml"\n    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"\n    xmlns="sap.m"><App id="app"></App></mvc:View>\n',
	"ui/view/Main.view.xml":'<mvc:View xmlns:richtexteditor="sap.ui.richtexteditor"\n    controllerName="ui.controller.main"\n    xmlns:html="http://www.w3.org/1999/xhtml"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns:tnt="sap.tnt"\n    displayBlock="true"\n    xmlns="sap.m"\n    xmlns:table="sap.ui.table"\n    xmlns:f="sap.f"\n    xmlns:w="sap.ui.integration.widgets"\n    xmlns:u="sap.ui.unified"\n    xmlns:card="sap.f.cards"\n    xmlns:core="sap.ui.core"\n    xmlns:form="sap.ui.layout.form"\n    xmlns:viz="sap.viz.ui5.controls"\n    xmlns:viz.data="sap.viz.ui5.data"\n    xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds"\n    xmlns:custom="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"\n    xmlns:dnd="sap.ui.core.dnd"\n><SplitApp\n\t\tid="SplitApp"\n\t\tinitialDetail="detail"\n\t\tinitialMaster="master"><detailPages><Page\n\t\t\t\tid="detail"\n\t\t\t\ttitle="Detail 1"\n\t\t\t\tbackgroundDesign= "Solid"><Label id="_IDGenLabel1" text="{resourceService>/}" /><Button id="_IDGenButton1" text="Download" press=".downloadPPTX" /></Page><Page\n\t\t\t\tid="detailDetail"\n\t\t\t\ttitle="Detail"\n\t\t\t\tbackgroundDesign= "Solid"\n\t\t\t\tshowNavButton="true"\n\t\t\t\tnavButtonPress="onPressDetailBack"><form:SimpleForm id="_IDGenSimpleForm1" \n                    layout="ResponsiveGridLayout"\n                    labelSpanXL="4"\n                    labelSpanL="1"\n                    labelSpanM="1"\n                    labelSpanS="1"\n                    adjustLabelSpan="false"\n                    emptySpanXL="0"\n                    emptySpanL="4"\n                    emptySpanM="0"\n                    emptySpanS="0"\n                    columnsXL="2"\n                    columnsL="1"\n                    columnsM="1"\n                    singleContainerFullSize="false"\n                    editable="true"><form:content><core:Title id="_IDGenTitle2" text="Content" /><Label id="_IDGenLabel11" text="Type"/><ComboBox id="comboBoxContentType" items="{contentTypes>/value}" selectedKey="{selected>/content/contentType/name}" width="200px"><core:Item id="_IDGenItem1" key="{contentTypes>name}" text="{contentTypes>name}"/></ComboBox><Label id="_IDGenLabel14" text="Content" visible="{= ${selected>/content/contentType/name} === \'RichText\' }"/><richtexteditor:RichTextEditor id="richTextEditor1" \n                            visible="{= ${selected>/content/contentType/name} === \'RichText\' }"\n                            editable="{= !${selected>/content/automated}}"\n                            value="{selected>/content/source}" \n                            width="100%"\n                            height="300px"\n                            showGroupFont="true"\n                            showGroupLink="true"\n                            showGroupInsert="true"></richtexteditor:RichTextEditor><Label id="_IDGenLabel10" text="Title" visible="{= ${selected>/content/contentType/name} === \'Section\' }"></Label><Input id="_IDGenLabel16" value="{selected>/content/source}" visible="{= ${selected>/content/contentType/name} === \'Section\' }"></Input><Label id="_IDGenLabel13" text="Layout" visible="{= ${selected>/content/contentType/name} === \'Section\' }"/><HBox id="_IDGenVBox2" visible="{= ${selected>/content/contentType/name} === \'Section\' }"><List id="checkBoxSectionType" class="horizontalList"><CustomListItem id="_IDGenCustomListItem1"><Image id="_IDGenImage1" src="resources/title_and_content.png"></Image></CustomListItem><CustomListItem id="_IDGenCustomListItem2"><Image id="_IDGenImage2" src="resources/two_contents.png"></Image></CustomListItem></List></HBox><core:Title id="_IDGenTitle3" text="{= ${selected>/content/contentType/name} !== \'Section\' ? \'Automate\' : \'\'}"/><Label id="_IDGenLabel15" text="Activated" visible="{= ${selected>/content/contentType/name} !== \'Section\' }"/><Switch id="_IDGenSwitch1" state="{selected>/content/automated}" enabled="{= ${selected>/content/contentType/name} !== \'Section\' }" visible="{= ${selected>/content/contentType/name} !== \'Section\' }"><layoutData><FlexItemData id="_IDGenFlexItemData1" growFactor="1" /></layoutData></Switch><Label id="_urlLabel" text="URL" visible="{= ${selected>/content/contentType/name} !== \'Section\' }"/><Input id="_IDGenInput2" editable="{selected>/content/automated}" value="{selected>/content/url}" visible="{= ${selected>/content/contentType/name} !== \'Section\' }"></Input><Label id="_selectorLabel" text="Selector" visible="{= ${selected>/content/contentType/name} !== \'Section\' }"/><Input id="_IDGenInput4" editable="{selected>/content/automated}" value="{selected>/content/selector}" visible="{= ${selected>/content/contentType/name} !== \'Section\' }"></Input><Button id="automationButton" text="Sync" width="200px" press="autoUpdateContent" visible="{= ${selected>/content/contentType/name} !== \'Section\' }"></Button><Label id="_IDGenLabel12" text=""/><Button id="_IDGenButton4" text="Save" type="Emphasized" press="onSave" width="200px"/></form:content></form:SimpleForm></Page></detailPages><masterPages><Page\n\t\t\t\tid="master"\n\t\t\t\ttitle="Master 1"\n\t\t\t\tbackgroundDesign= "List"><VBox id="_IDGenVBox1" ><table:TreeTable\n\t\t\t\t\tid="TreeTable"\n\t\t\t\t\tselectionMode="MultiToggle"\n\t\t\t\t\tenableSelectAll="false"\n\t\t\t\t\tariaLabelledBy="title"\n                    cellClick="onTreeCellClick"\n                    rows="{path:\'entities>/value\', parameters: {arrayNames:[\'children\']}}"><table:extension><OverflowToolbar id="_IDGenOverflowToolbar1" style="Clear"><Title id="title" text="P1"/><Button id="cut" text="Duplicate" icon="sap-icon://add-product" press="onCut"/><Button id="_IDGenButton3" icon="sap-icon://navigation-down-arrow" text="Expand all" press="expandAll"/><ToolbarSpacer id="_IDGenToolbarSpacer1"/><Button id="_IDGenButton2" text="Collapse all" press="onCollapseAll"/><Button id="_IDGenButton5" text="Export to .pptx" press="exportPressed"/><Button id="_IDGenButton6" text="Import .pptx" press="importPressed"/><Button id="_IDGenButton7" text="Open Popup" press="openPopup"/></OverflowToolbar></table:extension><table:dragDropConfig><dnd:DragDropInfo id="_IDGenDragDropInfo1"\n                                sourceAggregation="rows"\n                                targetAggregation="rows"\n                                dragStart="onDragStart"\n                                drop="onDrop"/></table:dragDropConfig><table:columns><table:Column id="_IDGenColumn1" width="9rem"><Label id="_IDGenLabel8" text="ID"/><table:template><Text id="_IDGenText2" text="{entities>content/source}" wrapping="false"/></table:template></table:Column><table:Column id="_IDGenColumn2" width="9rem"><Label id="_IDGenLabel9" text="Type"/><table:template><Text id="_IDGenText3" text="{entities>content/contentType/name}" wrapping="false"/></table:template></table:Column></table:columns></table:TreeTable><Label id="_IDGenLabel111" text="Resources" class="sapUiTinyMargin"></Label><List id="resourceList" mode="SingleSelectMaster" items="{contentTypes>/value}" selectionChange="resourceListItemSelectionChange"><items><StandardListItem id="_IDGenStandardListItem5" title="{contentTypes>name}"></StandardListItem></items></List></VBox></Page><Page\n\t\t\t\tid="master2"\n\t\t\t\ttitle="Master 2"\n\t\t\t\tbackgroundDesign="List"\n\t\t\t\tshowNavButton="true"\n\t\t\t\tnavButtonPress="onPressMasterBack"><List id="_IDGenList2" itemPress=".onListItemPress"><items><StandardListItem id="_IDGenStandardListItem2" title="To Detail 1" type="Active" custom:to="detail" /><StandardListItem id="_IDGenStandardListItem3" title="To Detail 2" type="Active" custom:to="detailDetail" /><StandardListItem id="_IDGenStandardListItem4" title="To Detail 3" type="Active" custom:to="detail2" /></items></List></Page></masterPages></SplitApp></mvc:View>\n',
	"ui/view/ui.view.xml":'<mvc:View controllerName="ui.controller.ui"\n    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"\n    xmlns="sap.m"><Page id="page" title="{i18n>title}"><content /></Page></mvc:View>\n'
});
//# sourceMappingURL=Component-preload.js.map
