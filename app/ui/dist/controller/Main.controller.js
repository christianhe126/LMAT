sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageBox","sap/m/Dialog","sap/m/Button","sap/ui/core/HTML","../model/utility"],function(e,t,n,o,r,a,i){"use strict";return e.extend("ui.controller.Main",{onInit:function(e){},autoUpdateContent:function(){var e=this.getView().getModel();var t=e.bindContext("/getAutoContent(...)");console.log(this.getView().getModel("selected").getData());const n=this.getView().getModel("selected").getProperty("/content/contentType/name");const o=this.getView().getModel("selected").getProperty("/content/url");const r=this.getView().getModel("selected").getProperty("/content/selector");console.log(n,o,r);t.setParameter("content",this.getView().getModel("selected").getProperty("/content"));t.execute().then(()=>{var e=t.getBoundContext().getObject();console.log("Data received:",e);this.getView().getModel("selected").setProperty("/content",e);console.log(this.getView().getModel("selected").getData())}).catch(function(e){console.error("Error:",e)})},openPopup:function(){var e="https://www.google.com";var t=new a({content:"<iframe src='"+e+"' style='width: 100%; height: 100%; border: 0;'></iframe>"});var n=new o({title:"External Content",contentWidth:"800px",contentHeight:"600px",content:t,beginButton:new r({text:"Close",press:function(){n.close()}})});n.open()},expandAll:function(){var e=this.getView().byId("TreeTable");e.expandToLevel(3)},exportPressed:function(){var e=JSON.stringify(this.getOwnerComponent().getModel("entities").getData().value);console.log(e);fetch("http://localhost:4004/export/generate_ppt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e})}).then(e=>{if(!e.ok){throw new Error("Network response was not ok "+e.statusText)}return e.text()}).then(e=>{let t=i.base64ToBlob(JSON.parse(e).value,"application/vnd.openxmlformats-officedocument.presentationml.presentation");const n=URL.createObjectURL(t);const o=document.createElement("a");o.href=n;o.download="MyPresentation.pptx";document.body.appendChild(o);o.click();o.remove()}).catch(e=>{n.error("Failed to generate presentation: "+e.message)})},importPressed:function(){fetch("http://localhost:4004/export/import_ppt",{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>{if(!e.ok){throw new Error("Network response was not ok "+e.statusText)}return e.text()}).then(e=>{console.log(e)}).catch(e=>{n.error("Failed to generate presentation: "+e.message)})},onTreeCellClick:function(e){var n=this.byId("TreeTable");var o=e.getParameter("rowIndex");var r=e.getParameter("cellControl").getParent().getIndex();var a=e.getParameter("rowBindingContext");if(a){var i=a.getObject();var s=new t(i);this.getView().setModel(s,"selected");console.log(i);this.getSplitAppObj().to(this.createId("detailDetail"))}},resourceListItemSelectionChange:function(e){var t=e.getParameter("listItem");var n=t.getBindingContext("contentTypes");var o=n.getObject();var r=this.getOwnerComponent().getModel("entities").getData().value;r.push({EntityID:i.findHighestEntityID(r)+1,parentEntityID:0,resourceID_resourceID:0,content:"New "+o.name,contentType:o.name,nodes:[]});this.getOwnerComponent().getModel("entities").setData({value:r});e.getSource().removeSelections(true)},onSave:function(){const e=this.getView().getModel("selected").getProperty("/entityID");var t=this.getOwnerComponent().getModel("entities").getData().value;let n=i.findInTree(e,t);n=this.getView().getModel("selected").getData();this.getOwnerComponent().getModel("entities").setData({value:t})},onPressDetailBack:function(e){this.getSplitAppObj().backDetail()},moveItemInTree:function(e,t){var n=e.getSource();var o=this.byId("myTree");var r=n.getParent().getModel();var a=r.getData();var i=n.getBindingContext();var s=i.getPath();var g=parseInt(s.split("/").pop(),10);if(t==1&&g>=1||t==-1&&g<=a.length-1){var l=s.substring(0,s.lastIndexOf("/"));var c=l?r.getProperty(l):a;var d=c[g-t];c[g-t]=c[g];c[g]=d;r.refresh()}},treeItemUpPress:function(e){this.moveItemInTree(e,1)},treeItemDownPress:function(e){this.moveItemInTree(e,-1)},onDragStart:function(e){var t=this.byId("TreeTable");var n=e.getParameter("dragSession");var o=e.getParameter("target");var r=o.getIndex();var a=t.getSelectedIndices();var i=[];if(a.length>0){if(a.indexOf(r)===-1){e.preventDefault()}else{for(var s=0;s<a.length;s++){i.push(t.getContextByIndex(a[s]))}}}else{i.push(t.getContextByIndex(r))}n.setComplexData("hierarchymaintenance",{draggedRowContexts:i})},onDrop:function(e){var t=this.byId("TreeTable");var n=e.getParameter("dragSession");var o=e.getParameter("droppedControl");var r=n.getComplexData("hierarchymaintenance").draggedRowContexts;var a=t.getContextByIndex(o.getIndex());if(r.length===0||!a){return}var i=t.getBinding().getModel();var s=a.getProperty();if(!s.nodes){s.nodes=[]}var g=false;for(var l=0;l<r.length;l++){if(a.getPath().indexOf(r[l].getPath())===0){continue}console.log(r[l].getPath());s.nodes.push(r[l].getProperty());i.setProperty(r[l].getPath(),undefined,r[l],true);g=true}if(g){t.expand(o.getIndex())}},getSplitAppObj:function(){var e=this.byId("SplitApp");if(!e){Log.info("SplitApp object can't be found")}return e}})});
//# sourceMappingURL=Main.controller.js.map